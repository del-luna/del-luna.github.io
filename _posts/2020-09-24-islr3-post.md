---
layout: post
title: ISLR chapter.3
author: Jaeheon Kwon
categories: Ai
tags: [islr]
---



## 3.1 Simple Linear Regression

단순 선형 회귀는 이름에 걸맞게 단일 예측 변수 $X$를 통해 정량적 반응 $Y$를 예측하는 매우 간단한 접근 방법입니다. $X$와 $Y$사이에는 선형적 관계가 있다고 가정합니다.

수학적으로 선형적 관계는 다음과 같이 나타낼 수 있습니다.

$$Y\approx \beta_0+\beta_1X\tag{3.1}$$



위 식에서 $\beta_0, \beta_1$은 선형 모델의 절편 및 기울기를 나타내는 두 개의 알 수 없는 상수입니다.(계수 혹은 파라미터 라고도 불림)

훈련 데이터를 사용하여 모델 계수에 대한 추정치 $\beta_0,\beta_1$을 생성하면 다음 식을 계산하여 TV특정 값을 계산 기반으로 미래 매출을 예측할 수 있습니다.

$$\hat y = \hat\beta_0+\hat\beta_1x\tag{3.2}$$

$\hat y$는 $X=x$를 기반으로한 $Y$에 대한 예측값입니다. ^ 기호는 알 수 없는 파라미터 혹은 계수에 대한 추정 값이거나, 반응 변수에 대한 예측 값을 나타내는 기호입니다.



### 3.1.1 Estimating the Coefficients

베타 값들은 알 수 없으니 식 3.1을 사용하여 예측하기 전에 데이터를 사용해서 계수를 추정해야 합니다.

$$(x_1,y_1),(x_2,y_2),...,(x_n,y_n)$$

$X,Y$에 대한 관측치로 구성된 $n$개의 페어가 있습니다.

광고의 예시에서 이 데이터 셋은 티비 광고 비용과 $n=200$개의 서로다른 시장에서의 제품 판매로 구성됩니다.

우리의 목표는 선형 모델 식 3.1이 데이터에 잘 맞도록  계수에 대한 추정 $\beta_0,\beta_1$을 얻는 것입니다. 즉, $i=1,...,n$에 대하여 $y_i \approx \hat\beta_0+\hat\beta_1x_i$가 됩니다.

다시말해서 200개의 데이터 포인트에 최대한 가까운 직선을 만들기 위해 편향과 기울기를 찾고 싶습니다.

거리를 측정하는 많은 방법이 존재하지만, 이 장에서는 최소 제곱을 기준으로 사용합니다.



$e_i=y_i-\hat y_i$는 $i$번째 관측된 반응과 반응 값에 대한 우리 선형 모델의 예측의 잔차입니다.

우리는 잔차 제곱 합 RSS를 다음과 같이 정의합니다.

$$RSS = e_1^2+e_2^2+\cdot\cdot\cdot+e_n^2$$

결국 최소 제곱법은 $RSS$를 최소화 하기 위해 $\beta_0,\beta_1$을 선택합니다.

$$\hat\beta_1 = \frac{\sum\limits_{i=1}^n(x_i-\bar x)(y_i-\bar y)}{\sum\limits_{i=1}^n(x_i-\bar x)^2} \\\hat\beta_0=\bar y-\hat\beta_1\bar x \tag{3.4}$$

$\bar x, \bar y$는 각각 샘플의 평균입니다.

다시말해서, 위 식은 선형 회귀를 통한 최소 제곱 계수 추정을 정의합니다.



<img src = "https://py-tonic.github.io/images/islr/3.1.png">



위 그림은  $\hat\beta_0=7.03, \hat\beta_1=0.0475$일 때 광고 데이터에 대한 단순 선형 회귀를 적용한 것을 보여줍니다.

위 근사치를 통해 TV광고에 1000달러를 추가했을 때 약 47.5개의 제품을 추가로 판매할 수 있다는 것을 알 수 있습니다.



<img src = "https://py-tonic.github.io/images/islr/3.2.png">

위 그림은 여러 가지 $\beta_0,\beta_1$에 대해 RSS값을 계산한 것을 보여줍니다.

빨간 점이 $RSS$를 최소화 하는 최적의 페어입니다.



### 3.1.2 Assesing the Accuracy of the Coefficient Estimates

우리는 2장에서 $X,Y$의 관계를 알 수 없는 함수 $f$와 평균이 0 인 $\epsilon$으로 정의했습니다.

$f$는 근사시킨 선형 함수이고, 다음과 같은 관계를 나타낼 수 있습니다.

$$Y = \beta_0+\beta_1X+\epsilon \tag{3.5}$$

에러 텀은 이 단순한 모델에서 놓친 모든 것들을 포괄합니다. 실제 관계는 선형이 아닐 수 있습니다. $Y$를 설명하기 위한 추가적인 변수가 필요할 수도 있고, 측정에서 오류가 있었을 수 있습니다.

 우리는 일반적으로 에러 텀을 $X$와 독립이라고 가정합니다.

위 식에 의해 주어진 모델은 $X,Y$사이의 실제 관계에 대한 모집단 회귀 선을 정의합니다.

최소 제곱 회귀 계수 추정은 최소 제곱 선을 특징화 합니다.



<img src = "https://py-tonic.github.io/images/islr/3.3.png">

위 왼쪽 그림은 단순한 시뮬레이팅 예시에 대한 두 직선입니다.



