---
layout: post
title: 연속값의 확률분포
author: Jaeheon Kwon
categories: Mathematics
tags: [statistics]
---



확률 변수 $X$의 cdf 는 $X$가 $x$보다 작은 값을 가질 확률 $P ( X\leq x )$로 정의한다.

$$F_X(x)=P\{X\leq x\}$$

확률을 잉크(잉크의 전체 량은 1)라고 생각해보자.

누적 분포 함수는 특정 면적에 잉크가 흩뿌려진 상태이고, 특정 부분이 짙으면 그 부분에서 잉크가 몰려있다는 뜻이다. 이를 잉크의 농도가 짙다 라고 표현하자.

cdf는 소비 잉크 양으로 볼 수 있고, cdf의 증가는 잉크가 뿌려진 것이다. 즉 이는 확률의 증가로 볼 수 있다.

- 특정 위치 a 까지의 소비 잉크 양 = $F_X(a)$ = a이하의 값이 나올 확률
- cdf의 증가량 = $F_X(x)$의 높이의 차이 = 잉크의 뿌려진 정도 = 확률
- 특정 위치 x에서 잉크의 농도(밀도) = pdf 

소비 잉크 양 $F_X(x)$를 미분하면 잉크의 농도(밀도)를 구할 수 있다.

$$f_X(x) = \frac{dF_x(x)}{dx}$$

우리는 1이라는 한정된 수량의 잉크를 특정 면적에 뿌려야 한다.

특정 부분에서 잉크를 많이 소모하게 되면 그 구간의 농도(밀도)는 높을 것이다. 소비된 잉크의 양이 급격하게 증가하는 시점의 기울기는 클 것이고, 이는 이 근방에서 잉크의 농도(밀도)가 높다는 것을 의미한다.

이 밀도를 나타내는 것이 바로 위 식이자 확률 밀도 함수로 불리는 pdf이다.

앞서 cdf의 증가량이 확률이라고 했다. 그렇다면 이를 pdf로 표현하면 어떻게 될까?

cdf의 미분이 pdf이니까 역연산인 적분을 활용해보자.

$$P\{a<X\leq b\} = F_x(X\leq b) - F(X\leq a)= \int_a^bf_X(x)dx$$

앞서 말했듯 cdf의 증가량(높이의 차)이 확률로 표현 가능하고, 이는 pdf의 면적과 동일하다.

재밌는 사실은 잉크의 농도(밀도) = $f_x(x)$인데, 이는 cdf의 기울기이며, pdf의 y값이 된다.

$f_x(x)$가 크다는 사실은 무엇을 의미할까? 확률? 아니다. pdf의 y값은 1이상의 값을 가질 수 있다. 

cdf의 기울기는 잉크가 증가하는 정도를 나타내고, 우리는 앞서 특정 부분이 짙다면 그 부분에 잉크가 몰려있다 라고 표현했으니 $f_X(x)$가 크다는 것은 그 근방의 값의 값이 나오기 쉬운 것으로 생각할 수 있다.

즉, 잉크가 증가하는 구간이므로 이 근처의 잉크가 많이 뿌려져있을 테고 이 근방의 값이 나올 확률이 높다 라고 생각할 수 있는 것이다.

> TMI
>
> cdf는 누적 분포 함수이므로 monotinic 이다. 그래서 cdf의 기울기를 잉크가 변화하는 정도가 아니라 증가하는 정도라고 표현할 수 있다. $(f_X(x))\geq0$
>
> $f_X(x)$를 likelihood라고 한다.
>
> MLE에서 분포함수를 미분해서 0되는 지점 찾는 것도(MLE)
>
> 어차피 극값이 존재하면 기울기=0인 지점이 likelihood의 최대 지점일 테니까 저렇게 수행하는게 아닐까 싶다.
>
> cdf의 기울기 = pdf의 y값 = liklihood
>
> pdf의 기울기가 0이되는 지점을 찾아서 likelihood가 제일 높은 지점을 찾자! MLE (이렇게 모든 문제를 풀 수는 없지만 일단은 이렇게 생각하자)



### 결합분포

두 개의 확률 변수 $X,Y$에 대한 확률 분포를 고려해봅시다.

직관적으로 1개의 변수에 대한 확률을 면적으로 고려할 수 있었으니, 두 개의 변수에 대한 확률은 이중 적분을 통해 부피라는 것을 떠올릴 수 있습니다.



![1](/Users/devcat/Desktop/cdfpdf/1.png)



$$P(a\leq X\leq b \cap c\leq Y \leq d) = \int_c^d(\int_a^bf_{XY}(x,y)dx)dy = \int_b^a(\int_c^df_{XY}(x,y)dy)dx$$

$$\int_{-\infty}^\infty(\int_{-\infty}^\infty f_{XY}(x,y)dx)dy = \int_{-\infty}^\infty(\int_{-\infty}^\infty f_{XY}(x,y)dy)dx = 1$$



### 주변분포

결합분포에서 특정 변수에 대한 단독 확률 분포를 생각해볼 수 있습니다.

$$f_X(x) = \int_{-\infty}^\infty f_{XY}(x,y)dy$$

$$f_Y(y) = \int_{-\infty}^\infty f_{XY}(x,y)dx$$



좀 더 자세히 적으면 다음과 같습니다. 임의의 구간의 확률은 다음과 같습니다.

$$P(a\leq X\leq b)=\int_{a}^b f_{X}(x)dx$$

$$P(a\leq X\leq b) = \int_a^b(\int_{-\infty}^\infty f_{XY}(x,y)dy)dx$$



### 조건부분포

 이산 확률분포 때의 정의를 가져와봅시다.

$$P(Y=b\vert X=a) = \frac{P(X=a,Y=b)}{P(X=a)}$$

연속 확률분포에서 위 식의 분모는 0이됩니다. 새로운 정의가 필요한 시점입니다.

결합분포의 pdf에 대해 $X=a$에서 잘라서 나온 단면을 고려해봅시다.

$X=a$라는 조건 하에 어떤 y값이 나오기 쉬울지는 이 잘린 단면을 통해 알 수 있습니다. 낮아진 곳은 그 부근의 값이 나오기 힘들다는 얘기겠죠?

잘린 단면의 형태를 다음과 같이 정의합시다.

$$g(y)=f_{XY}(a,y)$$

이 분포를 조건부 확률 분포 라고 하긴 조금 어렵습니다 왜냐면 저 함수의 모든 구간에 대한 적분값이 1이라는 보장이 아직 없습니다.

그렇다면 이렇게 해봅시다.

$$h(y)=\frac{g(y)}{c}$$

이제 c를 잘 조절해서 면적을 1로 만들면 어떨까요?

$$\int_{-\infty}^\infty h(y)dy = \frac1c\int_{-\infty}^\infty g(y)dy$$

그래서 $c=\int_{-\infty}^\infty g(y)dy$ 로 정의하면 1이 됩니다. 그런데 $\int_{-\infty}^\infty g(y)dy$ 는 다음과 같이 쓸 수 있습니다.

$$\int_{-\infty}^\infty g(y)dy = \int_{-\infty}^\infty f_{XY}(a,y)dy = f_X(a)$$



위 식을 사용해서 모두 사용해서 정리하면,

$$h(y)=\frac{g(y)}{c} = \frac{f_{XY}(a,y)}{f_x(a)}$$

$h(y)$를 조건부 확률 분포라고 합니다.

