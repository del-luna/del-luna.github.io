---
layout: post
title: 확률과 통계 기본(1)
author: Jaeheon Kwon
categories: 
tags: 
---



# 확률과 통계 기본(1)

수정중...



## 기본 용어

**Robust** : outlier에 민감하지 않다<br>
**Deviation**(편차) : 관측값 - 위치추정값<br> 
**Variance**(분산) : 평균에대한 편차를 제곱한값들의 합을 n-1로 나눈 값<br>
**Standard** **deviation**(표준 편차) : $sqrt(Variance)$<br>
**Sample Space**(표본 공간) : 발생 가능한 모든 사건들의 집합<br>
**Random variable**(확률 변수) : 표본공간에서 일정한 확률을 가지고 발생하는 사건에 수치를 일대일 대응시킨 함수 <br>

분산에 대해선 얘기할게 많다고 생각합니다.<br>
우선 편차의 "제곱"을 사용하는 이유와 값을 n-1로 나눠주는 이유 등이 있습니다.

전자는 절댓값이라는 방법도 쓸 수 있다고 알고 있는데
실제로 제가 왜 제곱을 하지 라고 생각했을 때 내린 결론은 단순합니다.

"절댓값은 미분이안되는데 제곱으로하면 미분이되잖아"

근데 실제로 어느정도 맞는 말이라고 합니다.<br>
그리고 또 다른 이유는 제곱의 합이 유클리드 거리를 계산하는 것으로도 볼 수 있기 때문입니다.<br>
유클리드 거리는 내적으로 부터 나오는 것이고 절댓값의 합과 같은 것들은 어떤 내적을 써도 만들 수 없습니다.<br>
[Minkowski distance]( [https://mrkevinna.github.io/%EA%B8%B0%EA%B3%84%ED%95%99%EC%8A%B5-%EA%B0%9C%EC%9A%94-3/](https://mrkevinna.github.io/기계학습-개요-3/) ) 를 참고하시면 좋을 것 같습니다.

후자에대한 예시를 들어보자면,<br>
표본분산을 계산하는 과정에서 표본평균을 구하게 되는 데<br>
표본평균이 정해지면 n-1개의 값만 알아도 나머지 하나를 알게 됩니다.<br>
그래서 나머지 하나는 자유롭게 어떤 값이든 취할 수 없게 되고 자유도가 하나 줄어듭니다.<br>
예를 들면 1,2,3,4,5 의 평균은 3인데<br>
1,2,3,4를 알고 있고 5개의 평균이 3이라는 걸 알고 있으면 나머지 하나의 값 x가 5라는 것을 알 수 있기 때문에<br>
5는 정해져버리는 값이 됩니다.<br>

위의 두 예시들은 자주 언급되어서 정리해봤지만

[데이터 과학을 위한 통계]( http://m.hanbit.co.kr/store/books/book_view.html?p_code=B2845507407 )라는 책에서 데이터사이언스의 입장에서는 자유도니 n-1이니 하는건 딱히 중요하지 않다고 언급합니다.

## 조건부확률

$P(B|A) = P(A∩B)/P(A)$ 
사건 A가 발생했을 때 사건 B가 발생할 확률입니다.

## 베이즈정리

**Prior Probability**(사전확률) : 관측자가 이미 알고 있는 사건으로부터 나온 확률
$ex) P(A_1), P(A_2), ... ,P(A_n)$

**Liklihood Probability**(우도) : 이미 알고 있는 사건이 발생했다는 조건 하에 다른 사건이 발생할 확률
$ex)P(B|A_1),P(B|A_2),...,P(B|A_n)$

**Posterior Probability**(사후확률) : 사전확률과 우도를 통해 알게되는 조건부 확률
$ex)P(A_k|B)$

예시를 들어보겠습니다.
<img src = "https://py-tonic.github.io/images/Probability/bayes.png">

그림판으로 그린거라서 퀄리티가 떨어지네요 ㅠㅠ...
이런거 그리기 쉬운사이트 있으면 추천 부탁드립니다..!

아무튼 세로선으로 인해 3갈래로 나눠진 면적을 A,B,C 나라라고 합시다.
면적의 합계 즉  P(Ω) = P(A) + P(B) + P(C) = 1입니다.
또한 이 나라들은 Red, Skyblue, Blue 구역으로 나눠집니다.
그렇다면 P(R) + P(S) + P(B) = 1입니다.

이제 위에서 배운 조건부확률을 이용해봅시다.<br>
A나라에서 Red 구역의 면적은 $P(A∩R)$ 입니다.<br>
B나라에서 Red 구역의 면적은 $P(B∩R)$ 입니다.<br>
C나라에서 Red 구역의 면적은 $P(C∩R)$ 입니다.<br>
그렇다면 P(R) = $P(A∩R)+P(B∩R)+P(C∩R)$ 임을 알 수 있습니다.<br>

마찬가지로 P(S)와 P(B) 또한 위처럼 교집합들의 합으로 정의할 수 있겠죠?<br>

이제 본격적인 얘기를 하기위해 ''비율'' 이라는 표현을 사용하겠습니다.<br>

예를들어 A나라에서 Red구역이 차지하는 ''비율''을<br>
 $P(R|A)$ 처럼 나타낼 수 있습니다.<br>
제가 다음으로 뭘 말할지 알겠죠? <br>
Skyblue, Blue 구역의 비율 또한 <br>
$P(S|A),P(B|A)$로 나타낼 수 있습니다.<br>

제가 앞서 "비율"이라는 표현을 사용했습니다.
그러므로 $P(R|A)+P(S|A)+P(B|A) = 1$ 이 되겠죠?(총 면적과는 관계 없습니다.)

또 면적과 비율에서<br>
$P(A∩R) = P(R|A)P(A)$<br>
$P(A∩S) = P(S|A)P(A)$<br>
$P(A∩B) = P(B|A)P(A)$ 라는 관계도 성립합니다.

말로 표현해보자면 
A나라의 ''면적''에 A나라의 Red구역 ''비율''을 곱하면 A나라의 Red구역 ''면적''이 나옵니다.<br>

<br>
자 그럼 이제 세로줄 좌우를 지금까지와 반대로 한 <br>
$P(A|R)$같은 식은 어떤 의미가 될까요?<br>

$P(A|R) = P(A∩R)/P(R)$이라는 식이 됩니다.<br>
즉, Red 구역의 총면적 P(R) 중에서 A나라의 Red구역이 차지하는 비율을 나타냅니다.
<br>

이게 베이즈정리의 끝입니다.<br>

A,B,C 나라를 각각 $A_1,A_2,A_3$로 변경하겠습니다.<br>
$P(R)=P(A_1∩R)+P(A_2∩R)+P(A_3∩R)$임을 우리는 알고 있습니다.<br>

<br>

Bayes 정리는<br>
Posterior $P(A_1|R)$를 직접 구할 수 없어서, 추정하려할 때<br>
Prior $P(A_1),P(A_2),P(A_3)$와 <br>
Liklihood $P(R|A_1),P(R|A_2)P(R|A_3)$를 이용하여 구하겠다는 말입니다.<br>

<br>

즉 말로 풀어서 해보자면<br>
위의 전체 나라별 면적 $P(Ω) = P(A_1) + P(B_2) + P(C_3) = 1$ 과<br> 
나라별 R구역의 면적 $P(R|A_1)P(A_1),P(R|A_2)P(A_2),P(R|A_3)P(A_3)$을 알고 있다면 Red구역중 $A_1$나라가 차지하는 비율을 구할 수 있겠죠?<br>

사실 그냥 단순히 말해서  위에서 정의한 "비율"의 역연산일 뿐입니다.<br>

최종 정리하자면
$P(A_1|R)$ <br>

Red구역에서 $A_1$나라가 차지하는 비율은<br>

$= P(A_1∩R)/P(R)$<br>

조건부 확률에 의해 기본적으로 위 식처럼 정의되고 <br>

$= P(A_1∩R)/P(A_1∩R)+P(A_2∩R)+P(A_3∩R)$<br>

Red구역의 정의는 각 나라별 Red구역의 합으로 표현할 수 있으며<br>
<br>
$= P(R|A_1)P(A_1)/P(R|A_1)P(A_1)+P(R|A_2)P(A_2)+P(R|A_3)P(A_3)$<br>

따라서 위 식처럼 조건부확률의 변형을 통해 구할 수 있습니다.<br>

한글로 풀어서 설명하자면<br>

분자 = $A_1$나라의 면적 x $A_1$나라의 Red구역 비율 = $A_1$나라의 Red구역 면적이고,<br>

분모 = 각 나라별 Red구역 면적의 합 = 총 Red구역의 면적 이므로<br>

Red구역에서 $A_1$나라가 차지하는 비율을 구하는 것임을 알 수 있습니다.<br>

## 기댓값

확률변수 X란 Sample Space(Ω)위에서 정해진 함수로 정의했습니다.
Ω의 각 원소  ω에 대해 X(ω)를 높이 축에 따라 그려보겠습니다.

우선 
X=5 : 면적 = 1/6
X=2 : 면적 = 1/3
X=1 : 면적 = 1/2 라고 정의하겠습니다.

아까 소개했던 A,B,C나라를 다시 불러보겠습니다.
<img src = "https://py-tonic.github.io/images/Probability/0.png">

각 나라별 확률의 결과값을 축으로하는 그래프를 그려보면
<img src = "https://py-tonic.github.io/images/Probability/1.png">

3D모형의 부피가 기댓값이 됩니다.
$E[X] = (h:1)(w:1/2) + (h:2)(w:1/3) + (h:5)(w:1/6)$

즉, 이 때의 기댓값 E는 2입니다. 여기서 우리는 면적을 1로 정의했기에
각 확률별 output이자 높이인 1,2,5의 평균이 기댓값임을 알 수 있습니다.

즉, 기댓값 E[x] = ''어떤 사건이 일어날 확률'' x ''그 사건의 결과값'' 을 구해서 합하면 됩니다.

우선은 여기까지 정리하겠습니다.
나중에 기회가 된다면 확률밀도함수나 정규화 등에 대해서도 정리해보겠습니다
