---
layout: post
title: for문으로 변수를 생성하고 가져올 수는 없을까?(feat.sys)
author: Jaeheon Kwon
categories: Python
tags: [tips]
---



파이썬을 처음 배우고 문법에 익숙하지 않을 때 이런 생각을 한 적이 있다.

변수 여러개 생성할 때 for문으로 할 수는 없을까?

혹은 a1, a2, a3, ... 같은 변수가 있을 때 for문으로 저 변수 들을 불러올 수 없을까?

물론 우리에게는 여러가지 시퀀스 객체가 있지만 저 때는 유연한 사고를 할 수 없는 뉴비일 때 얘기였다.



아무튼 갑자기 이 얘기를 쓰는 이유는 나처럼 생각하고 질문하는 사람이 단톡방에 있어서 해결 방법을 고민하다가 결국 찾기는 찾았다. (근데 좀 별로다 ㅋㅋㅋ 그냥 시퀀스 객체 쓰자...)



우선 리플렉션을 활용해서 for문에서 동적으로 변수를 생성할 수 있다.

```python
import sys
mod = sys.modules[__name__] #현재 로딩되어 있는 모듈들
for i in range(10):
	setattr(mod, f'a{i}', i) #속성을 변경해줌.
```

이렇게 되면 sys.modules[\__name\_\_]에 a1~a10이라는 속성 값을 생성하고 거기에 1~10이라는 값이 생성된다.



추가적으로 globals()를 사용하는 방법도 있다.

```python
for i in range(10):
    globals()[f'a{i}'] = i
```

globals()는 전역변수들을 딕셔너리 형태로 보여주는 메소드인데 여기에 딕셔너리 형태로 값을 추가하는 방법인 것 같다. sys.modules보다 훨씬 깔끔한듯..?

## Sys module

추가적으로 이번 기회에 sys모듈에 대해 조금 알게 된게 있어서 적어보면,

파이썬은 크게 세 가지 구역에서 다음과 같은 순서로 모듈과 패키지를 찾는다.

sys.modules, built-in modules, sys.path

sys.modules은 처음으로 살피는 영역인데 딕셔너리 형태로 되어 있다.

```python
>>> print(sys.modules)
{'sys': <module 'sys' (built-in)>, 'builtins': <module 'builtins' (built-in)>,...}
```

너무 길어서 잘랐다...



파이썬 실행 후 한 번이라도 import 되었다면, 다시 모듈을 찾지 않고 sys.modules를 확인해서 사용한다고 한다.

buit-in modules는 우리에게 친숙한 내장함수가 있는 곳이다. 위에 코드블럭에서 보이는 sys가 대표적인 예시이다.



sys.path는 파이썬이 모듈이나 패키지를 찾을 때 가장 마지막으로 확인하는 부분이다. pip로 설치한 라이브러리를 이 곳을 통해서 찾게 되며 새롭게 작성한 패키지나 모듈을 사용할 땐 여기에 path등록을 해서 찾게끔 설정한다.

```python
>>>print(sys.path)
['/home/devcat', '/home/devcat/anaconda3/envs/devcat/lib/python38.zip', '/home/devcat/anaconda3/envs/devcat/lib/python3.8', '/home/devcat/anaconda3/envs/devcat/lib/python3.8/lib-dynload', '', '/home/devcat/.local/lib/python3.8/site-packages', '/home/devcat/anaconda3/envs/devcat/lib/python3.8/site-packages', '/home/devcat/anaconda3/envs/devcat/lib/python3.8/site-packages/IPython/extensions', '/home/devcat/.ipython']
```

내 리눅스 디렉토리들인데, 나는 가상환경을 사용하므로 보통 pip를 통해 설치한 라이브러리들은 '/home/devcat/anaconda3/envs/devcat/lib/python3.8/site-packages' 여기에 위치하는 걸 확인할 수 있었다.

sys.modules는 딕셔너리 형태이지만 sys.path는 리스트 형태로 존재한다는 점도 차이가 있다.



그렇다면 for문을 통해 이미 생성된 a1, a2, a3, ...와 같은 변수는 어떻게 불러올 수 있을까?

좀 고민을 해봤는데 다음과 같이 eval을 써서 해결했다.(eval은 사실 안쓰는게 좋습니다. 이유가 궁금하다면 [여기](https://bluese05.tistory.com/64)를 클릭하세요)

```python
[eval('a'+str(i))for i in range(1,10)]
```



결론은 sys.module과 setattr() 쓰는건 솔직히 귀찮고...

eval()또한 보안의 위험성과 코드 가독성을 떨어뜨리니 그냥 시퀀스 객체를 사용하자.



## Reference

[sys module 정리]([https://velog.io/@ybear90/Python-%EB%AC%B8%EB%B2%95%EC%97%90-%EA%B4%80%ED%95%9C-%EB%82%B4%EC%9A%A9-%EC%9D%BC%EB%B6%80-%EC%A0%95%EB%A6%AC-6-sys-module-path-%EC%A0%95%EB%A6%AC](https://velog.io/@ybear90/Python-문법에-관한-내용-일부-정리-6-sys-module-path-정리))